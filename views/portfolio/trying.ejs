<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Education Form</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-datepicker/dist/js/bootstrap-datepicker.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-datepicker/dist/css/bootstrap-datepicker.min.css" rel="stylesheet">
</head>
<body>
  <div class="container mt-5">
    <h1>Education Details</h1>
    <form id="educationForm" method="post" action="/auth/education_detail">
      <div id="educationContainer">
        <!-- Single Education Entry -->
        <div class="card card-body mb-3" id="education1">
          <div class="mb-3">
            <label for="degree1" class="form-label">Degree</label>
            <input type="text" class="form-control" id="degree1" name="degree[]" placeholder="E.g., Bachelor of Science" required>
          </div>
          <div class="mb-3">
            <label for="institution1" class="form-label">Institution</label>
            <input type="text" class="form-control" id="institution1" name="institution[]" placeholder="E.g., University of XYZ" required>
          </div>
          <div class="mb-3">
            <label for="start1" class="form-label">Start Date</label>
            <input type="text" class="form-control datepicker" id="start1" name="start[]" placeholder="Start Date" required>
          </div>
          <div class="mb-3">
            <label for="end1" class="form-label">End Date</label>
            <input type="text" class="form-control datepicker" id="end1" name="end[]" placeholder="End Date">
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="current1" name="current[]" value="true" onchange="toggleEndDate(1)">
            <label class="form-check-label" for="current1">Currently Enrolled</label>
          </div>
        </div>
      </div>

      <button type="button" class="btn btn-primary" onclick="addEducation()">Add Another</button>
      <button type="submit" class="btn btn-success">Submit</button>
    </form>
  </div>

  <script>
    let educationIndex = 1;

    $(document).ready(function () {
      // Initialize datepicker
      $('.datepicker').datepicker({ format: 'yyyy-mm-dd', autoclose: true });
    });

    function toggleEndDate(index) {
      const currentCheckbox = document.getElementById(`current${index}`);
      const endDateInput = document.getElementById(`end${index}`);
      if (currentCheckbox.checked) {
        endDateInput.disabled = true;
        endDateInput.value = 'present'; // Set to 'present' when currently enrolled
      } else {
        endDateInput.disabled = false;
      }
    }

    function addEducation() {
      educationIndex++;
      const container = document.getElementById('educationContainer');
      const newEducation = `
        <div class="card card-body mb-3" id="education${educationIndex}">
          <div class="mb-3">
            <label for="degree${educationIndex}" class="form-label">Degree</label>
            <input type="text" class="form-control" id="degree${educationIndex}" name="degree[]" placeholder="E.g., Bachelor of Science" required>
          </div>
          <div class="mb-3">
            <label for="institution${educationIndex}" class="form-label">Institution</label>
            <input type="text" class="form-control" id="institution${educationIndex}" name="institution[]" placeholder="E.g., University of XYZ" required>
          </div>
          <div class="mb-3">
            <label for="start${educationIndex}" class="form-label">Start Date</label>
            <input type="text" class="form-control datepicker" id="start${educationIndex}" name="start[]" placeholder="Start Date" required>
          </div>
          <div class="mb-3">
            <label for="end${educationIndex}" class="form-label">End Date</label>
            <input type="text" class="form-control datepicker" id="end${educationIndex}" name="end[]" placeholder="End Date">
          </div>
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="current${educationIndex}" name="current[]" value="true" onchange="toggleEndDate(${educationIndex})">
            <label class="form-check-label" for="current${educationIndex}">Currently Enrolled</label>
          </div>
        </div>
      `;
      container.insertAdjacentHTML('beforeend', newEducation);
      $(`#start${educationIndex}, #end${educationIndex}`).datepicker({ format: 'yyyy-mm-dd', autoclose: true });
    }

  </script>
</body>
</html>
